<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>geod19804 • carlosmarrero</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="geod19804">
<meta property="og:description" content="carlosmarrero">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">carlosmarrero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Tarea1.html">geod19804</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Tarea1_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>geod19804</h1>
                        <h4 class="author">Carlos Gabriel Marrero Pérez</h4>
            
            <h4 class="date">2021-04-10</h4>
      
      
      <div class="hidden name"><code>Tarea1.Rmd</code></div>

    </div>

    
    
<div id="tarea-1" class="section level2">
<h2 class="hasAnchor">
<a href="#tarea-1" class="anchor"></a>Tarea 1</h2>
</div>
<div id="cargamos-las-librerías" class="section level1">
<h1 class="hasAnchor">
<a href="#cargamos-las-librer%C3%ADas" class="anchor"></a>Cargamos las librerías</h1>
<p>Los datos pueden encontrarse en <a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-GEOD-19804/samples/?keywords=&amp;organism=Homo+sapiens&amp;exptype%5B%5D=%22rna+assay%22&amp;exptype%5B%5D=&amp;array=A-AFFY-44&amp;page=4&amp;pagesize=25"></a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biobase">Biobase</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/seandavi/GEOquery">GEOquery</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">affy</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">hgu133plus2.db</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/AnnotationDbi">AnnotationDbi</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="elección-del-experimento" class="section level1">
<h1 class="hasAnchor">
<a href="#elecci%C3%B3n-del-experimento" class="anchor"></a>Elección del experimento</h1>
<p>Para llevar a cabo esta tarea se ha elegido el DataSet GDS3837, que se corresponde con la serie <strong>GSE19804</strong> (que es la referencia que se utilizará en todo el documento).</p>
<p><strong>Título:</strong> estudio de genoma completo de modulación transcriptómica en mujeres no fumadoras con cáncer de pulmón en Taiwán. Si bien el tabaquismo es el mayor factor de riesgo para desarrollar cáncer de pulmón, tan solo el 7% de las pacientes con cáncer de pulmón taiwanesas tienen un historial de consumo de tabaco, porcentaje mucho más básico que el correspondiente a mujeres caucásicas. Este estudio es un análisis exhaustivo de la “firma molecular” (conjunto de genes, tránscritos de mRNA, proteínas…) del sujeto de estudio descrito. Dado que las encuestas de gran escala sobre mecanismos moleculares en estas mujeres no eran comunes, se decidió llevar a cabo este experimento. Fueron extraídas 102 muestras de tumores pulmonares y sus respectivas contrapartes sanas. El RNA de los pares fue examinado mediante el microarray Affymetrix Human U133 plus2.0, mientras que el DNA fue analizado a través de arrays Affymetrix SNP 6.0, para buscar polimorfismos de un solo nucleótido.</p>
<div id="información-previa-del-experimento" class="section level3">
<h3 class="hasAnchor">
<a href="#informaci%C3%B3n-previa-del-experimento" class="anchor"></a>Información previa del experimento</h3>
<pre><code>-Animal de estudio: Homo sapiens
-Número de muestras:  120
-Array: [HG-U133_Plus_2] Affymetrix Human Genome U133 Plus 2.0 Array</code></pre>
</div>
</div>
<div id="descarga-y-preprocesado-de-la-información" class="section level1">
<h1 class="hasAnchor">
<a href="#descarga-y-preprocesado-de-la-informaci%C3%B3n" class="anchor"></a>Descarga y preprocesado de la información</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu">GEOquery</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/GEOquery/man/getGEOSuppFiles.html">getGEOSuppFiles</a></span><span class="op">(</span><span class="st">"GSE19804"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"tar xvf GSE19804/GSE19804_RAW.tar"</span><span class="op">)</span>
<span class="co"># Procesamos los ficheros cel y creamos un objeto AffyBatch de nombre "datossinnorm"</span>
<span class="va">datossinnorm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/affy/man/read.affybatch.html">ReadAffy</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"rm -fr GSE19804"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"rm *CEL.gz"</span><span class="op">)</span></code></pre></div>
<p>En primer lugar, haciendo uso de la función</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/affy/man/MAplot.html">MAplot</a></span></code></pre></div>
<p>realizamos los <strong>MA-plot</strong> de cada array contra el pseudoarray de referencia antes de normalizar los datos. Estas gráficas permiten visualizar las diferencias entre las medidas tomadas en dos muestras, transformando los datos en dos escalas <span class="math inline">\(M\)</span> (log ratio) y <span class="math inline">\(A\)</span> (media aritmética) y luego dibujando esos valores. <span class="math inline">\(M\)</span> y <span class="math inline">\(A\)</span> vienen definidas por, en un ejemplo entre intensidades rojas contra verdes (<span class="math inline">\(R\)</span> vs. <span class="math inline">\(G\)</span>): <span class="math display">\[M=\log_{2}(R/G),\]</span> <span class="math display">\[A=\frac{1}{2}\log_2(RG)\]</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/affy/man/MAplot.html">MAplot</a></span><span class="op">(</span><span class="va">datossinnorm</span><span class="op">)</span></code></pre></div>
<p>Ahora, obtenemos los <strong>estimadores de densidad</strong> y los comparamos en un histograma:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="fu">hist</span><span class="op">(</span><span class="va">datossinnorm</span><span class="op">)</span></code></pre></div>
<p>Por último, creamos los <strong>diagramas de cajas</strong> para cada muestra:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="fu">boxplot</span><span class="op">(</span><span class="va">datossinnorm</span>,col<span class="op">=</span><span class="st">"blue"</span>, 
        main<span class="op">=</span><span class="st">"Diagrama de cajas preprocesamiento"</span>,
        ylab<span class="op">=</span><span class="st">"Intensidad en log2"</span>, 
        xlab<span class="op">=</span><span class="st">"Muestras"</span>, names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<div id="preprocesamiento-de-los-datos" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocesamiento-de-los-datos" class="anchor"></a>Preprocesamiento de los datos</h2>
<p>Para preprocesar la información hacemos uso del algoritmo RMA (<em>Robust Multi-array Average</em>), en el que los valores sin tratar de intensidad se “limpian” de ruido de fondo, se transforman a logaritmo en base 2 y se normalizan en cuantiles. Posteriormente, un modelo lineal se ajusta a los datos normalizados para obtener una medida de la expresión para cada conjunto de sondas de cada <em>array</em>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datosnorm</span> <span class="op">&lt;-</span> <span class="fu">affy</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/affy/man/rma.html">rma</a></span><span class="op">(</span><span class="va">datossinnorm</span><span class="op">)</span></code></pre></div>
<p>A partir de los datos normalizados, obtenemos la matriz de expresión.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrizexpr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html">exprs</a></span><span class="op">(</span><span class="va">datosnorm</span><span class="op">)</span></code></pre></div>
<p>Ahora que hemos tratado los datos, repetimos las tres fases del estudio cualitativo anterior.</p>
<p><strong>MA-plot de los datos normalizados</strong>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/affy/man/MAplot.html">MAplot</a></span><span class="op">(</span><span class="va">datosnorm</span><span class="op">)</span></code></pre></div>
<p><strong>Estimadores de densidad de los datos normalizados</strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="fu">hist</span><span class="op">(</span><span class="va">datosnorm</span><span class="op">)</span></code></pre></div>
<p><strong>Diagramas de cajas de los datos normalizados</strong></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">affy</span><span class="fu">::</span><span class="fu">boxplot</span><span class="op">(</span><span class="va">datosnorm</span>,col<span class="op">=</span><span class="st">"orange"</span>, 
        main<span class="op">=</span><span class="st">"Diagrama de cajas postprocesado"</span>,
        ylab<span class="op">=</span><span class="st">"Intensidad en log2"</span>, 
        xlab<span class="op">=</span><span class="st">"Muestras"</span>, names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
</div>
<div id="elaboración-del-expressionset" class="section level2">
<h2 class="hasAnchor">
<a href="#elaboraci%C3%B3n-del-expressionset" class="anchor"></a>Elaboración del ExpressionSet</h2>
<p>Rellenamos la información de los datos en formato MIAME</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">infoData</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="st">'MIAME'</span>,
        name<span class="op">=</span><span class="st">'Tzu-Pin Lu'</span>,
        lab<span class="op">=</span><span class="st">'National Taiwan University, Taiwan'</span>,
        contact <span class="op">=</span><span class="st">'tplu@ntu.edu.tw'</span>,
                     url <span class="op">=</span><span class="st">"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE19804"</span>,
             pubMedIds <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"20802022"</span>,<span class="st">"25889623"</span><span class="op">)</span>,
             title <span class="op">=</span> <span class="st">"  Genome-wide screening of transcriptional modulation in non-smoking female
        lung cancer in Taiwan"</span>,
             abstract <span class="op">=</span> <span class="st">"Although smoking is the major risk factor for lung cancer, only 7% of female 
             lung cancer patients in Taiwan have a history of cigarette smoking, extremely 
             lower than those in Caucasian females. 
        This report is a comprehensive analysis of the molecular signature of 
        non-smoking female lung cancer in Taiwan."</span><span class="op">)</span>

<span class="va">finput</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"externaldata"</span>,<span class="st">"atributos.csv"</span>, package <span class="op">=</span> <span class="st">"carlosmarrero"</span><span class="op">)</span>
<span class="va">pd0</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">finput</span>, header<span class="op">=</span><span class="cn">TRUE</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">metadatos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>labelDescription <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-toTable.html">colnames</a></span><span class="op">(</span><span class="va">pd0</span><span class="op">)</span>,row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-toTable.html">colnames</a></span><span class="op">(</span><span class="va">pd0</span><span class="op">)</span><span class="op">)</span>
<span class="va">datosfenotipo</span> <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="st">"AnnotatedDataFrame"</span>, data <span class="op">=</span> <span class="va">pd0</span>, varMetadata <span class="op">=</span> <span class="va">metadatos</span><span class="op">)</span>
<span class="va">geod19804</span>  <span class="op">=</span> <span class="fu">new</span><span class="op">(</span><span class="st">"ExpressionSet"</span>,
                exprs<span class="op">=</span><span class="va">matrizexpr</span>,
                phenoData <span class="op">=</span> <span class="va">datosfenotipo</span>,
                experimentData <span class="op">=</span> <span class="va">infoData</span>,
                annotation<span class="op">=</span><span class="st">'hgu133plus2'</span><span class="op">)</span></code></pre></div>
</div>
<div id="anotación" class="section level2">
<h2 class="hasAnchor">
<a href="#anotaci%C3%B3n" class="anchor"></a>Anotación</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">=</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">select</a></span><span class="op">(</span><span class="fu">hgu133plus2.db</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/hgu133plus2.db/man/hgu133plus2BASE.html">hgu133plus2.db</a></span>,keys<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureNames.html">featureNames</a></span><span class="op">(</span><span class="va">geod19804</span><span class="op">)</span>,
                          column<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ENTREZID"</span>,<span class="st">"ENSEMBL"</span>,<span class="st">"GENENAME"</span><span class="op">)</span>,keytype<span class="op">=</span><span class="st">"PROBEID"</span><span class="op">)</span>
<span class="va">a</span> <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span>,<span class="st">"ENTREZID"</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureNames.html">featureNames</a></span><span class="op">(</span><span class="va">geod19804</span><span class="op">)</span>,<span class="va">a</span><span class="op">[</span>,<span class="st">"PROBEID"</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html">fData</a></span><span class="op">(</span><span class="va">geod19804</span><span class="op">)</span> <span class="op">=</span> <span class="va">a</span><span class="op">[</span><span class="va">b</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">geod19804</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html">fData</a></span><span class="op">(</span><span class="va">geod19804</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">geod19804</span>,file<span class="op">=</span><span class="st">"geod19804.rda"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Carlos Marrero.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
